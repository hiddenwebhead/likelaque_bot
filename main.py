...(тот же самый код как ранее, опущен для краткости)...